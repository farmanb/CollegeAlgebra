<?xml version="1.0" encoding="UTF-8"?>

<section xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Composition and Inverses</title>
  <introduction>
    <p>
      Another way to create new functions from existing functions is through composition.
    </p>
  </introduction>

  <definition>
    <title>Composition of Functions</title>
    <p>
      Assume <m>f \colon A \to B</m> and <m>g \colon C \to D</m> be functions with <m>B \subseteq C</m>.
      The <term>composition</term>
      <idx>
	<h>Function</h>
	<h>Composition</h>
      </idx>
      of <m>g</m> with <m>f</m> is the function <m>g \circ f \colon A \to D</m>
      <notation>
	<usage>
	  <m>g \circ f</m>
	</usage>
	<description>Composition of <m>g</m> with <m>f</m></description>
      </notation>
      defined by
      <me>(g \circ f)(x) = g\left(f\left(x\right)\right).</me>
    </p>
  </definition>

  <example>
    <p>
      Consider the functions <m>f \colon \R \to \R</m> defined by <m>f(x) = x+2</m> and <m>g \colon \R \to \R</m> defined by <m>g(x) = x^2 + 3</m>.
      The composition of <m>g</m> with <m>f</m> is the function <m>g \circ f \colon \R \to \R</m> defined by
      <md>
	<mrow>(g \circ f)(x) = g\left(f(x)\right)
	\amp= g\left(x + 2\right)</mrow>
	<mrow>\amp= \left(x + 2\right)^2 + 3</mrow>
	<mrow>\amp= (x + 2)(x + 2) + 3</mrow>
	<mrow>\amp= x^2 + 2x + 2x + 4 + 3</mrow>
	<mrow>\amp = x^2 + 4x + 7</mrow>
      </md>
    </p>
  </example>

  <warning>
    <p>
      It is important to make sure the range of the function <m>f</m> is contained within the domain of the function <m>g</m>.
      If not, the composition does not make sense.
    </p>
  </warning>

  <example>
    <p>
      The function <m>g \colon [0,\infty) \to \R</m> defined by <m>g(x) = \sqrt{x}</m> cannot be composed with the function <m>f \colon [0, \infty) \to (-\infty,0]</m> defined by <m>f(x) = -x</m> because
      <me>(g \circ f)(x) = g(-x) = \sqrt{-x}</me>
      is <alert>not</alert> a real number when <m>x > 0</m>!
    </p>
  </example>

  <warning>
    <p>
      The order of composition matters.
      Even if <m>f \circ g</m> and <m>g \circ f</m> are both well-defined and have the same domain, these two functions <alert>are not the same</alert> in general.
    </p>
  </warning>

  <example>
    <p>
      Consider the functions <m>f \colon \R \to \R</m> defined by <m>f(x) = x+2</m> and <m>g \colon \R \to \R</m> defined by <m>g(x) = x^2 + 3</m>.
      The composition of <m>f</m> with <m>g</m> is the function <m>f \circ g \colon \R \to \R</m> defined by
      <md>
	<mrow>(f \circ g)(x) = f\left(f(x)\right)
	\amp= g\left(x^2 + 3\right)</mrow>
	<mrow>\amp= \left(x^2 + 3\right) + 2</mrow>
	<mrow>\amp= x^2 + 5</mrow>
	<mrow>\amp\neq x^2 + 4x + 7 = (g \circ f)(x).</mrow>
      </md>      
    </p>
  </example>
  

  <subsection>
    <title>Composition Inverses</title>
    <definition>
      <title>Identity Function</title>
      Assume <m>A</m> is a set.
      The <term>identity function</term> on <m>A</m> is the function <m>\id \colon A \to A</m> defined by
      <me>\id_A(x) = x.</me>
    </definition>

    <p>
      We call this function the identity function because it behaves similar to the multiplicative identity, <m>1</m>.
      The number <m>1</m> satisfies the property that for all real numbers <m>x</m>, <m>1 \times x = x = x \times 1</m>.
      For every function <m>f \colon A \to B</m>, the identity function on <m>A</m> satisfies <m>f \circ \id_A = f</m> because
      <me>(f \circ \id_A)(x) = f\left(\id_A(x)\right) = f(x)</me>
      and the identity function on <m>B</m> satisfies <m>\id_B \circ f = f</m> because
      <me>(\id_B \circ f)(x) = \id_B\left(f(x)\right) = f(x)</me>.
    </p>

    <p>
      Every non-zero real number, <m>x</m>, has an inverse with respect to the multiplication operation which we call <m>1/x</m>.
      The inverse is defined by being the unique real number that satisfies
      <me>x\left(\frac{1}{x}\right) = 1 \quad\text{and}\quad \left(\frac{1}{x}\right)x = 1.</me>
      For a function, we define an inverse with respect to the composition operation similarly.
    </p>

    <definition>
      <title>Composition Inverse</title>
      <p>
	Assume <m>f \colon A \to B</m> is a function.
	The <term>composition inverse</term>, if it exists, is a function <m>f^{-1} \colon B \to A</m> that satisfies
	<me>f^{-1} \circ f = \id_A
	\quad\text{and}\quad
	f \circ f^{-1} = \id_B
	</me>
	or, equivalently, for every <m>x \in A</m>
	<m>f^{-1} \circ f(x) = x</m>
	and for every <m>y \in B</m>,
	<m>f \circ f^{-1}(y) = y</m>.
      </p>
    </definition>

    <example>
      <p>
	The linear function <m>f(x) = 3x + 5</m> is an invertible function.
	We can find its inverse by solving the equation <m>y = 3x + 5</m> for <m>x</m> in terms of <m>y</m>
	<md>
	  <mrow>y \amp= 3x + 5 \amp\amp \text{Subtract}\ 5\ \text{from both sides}</mrow>
	  <mrow>3x \amp = y - 5 \amp\amp \text{Divide both sides by}\ 3</mrow>
	  <mrow>x \amp = \frac{y - 5}{3} \amp\amp\text{Simplify}</mrow>
	  <mrow>x \amp = \frac{1}{3}y - \frac{5}{3}.</mrow>
	</md>
	This tells us the inverse function is
	<me>f^{-1}(y) = \frac{1}{3} y - \frac{5}{3}.</me>
      </p>
      <p>
	We can verify that these two functions are inverses to one another by computing
	<md>
	  <mrow>\left(f^{-1} \circ f\right)(x) \amp= f^{-1}\left(3x + 5\right)</mrow>
	  <mrow>\amp= \frac{1}{3}\left(3x + 5\right) - \frac{5}{3}</mrow>
	  <mrow>\amp= x + \frac{5}{3} - \frac{5}{3}</mrow>
	  <mrow>\amp= x</mrow>
	</md>
	and
	<md>
	  <mrow>\left(f \circ f^{-1}\right)(y) \amp= f\left(\frac{1}{3}y - \frac{5}{3}\right)</mrow>
	  <mrow>\amp= 3\left(\frac{1}{3}y - \frac{5}{3}\right) + 5</mrow>
	  <mrow>\amp= y - 5 + 5</mrow>
	  <mrow>\amp= y.</mrow>
	</md>
      </p>
    </example>
  </subsection>

</section>
